@if (isLoading) {
  <div class="reviews-loading">
    <div class="loading-grid">
      @for (item of [1,2,3,4]; track $index) {
        <div class="review-skeleton"></div>
      }
    </div>
  </div>
} @else if (userReviews.length === 0) {
  <div class="reviews-empty">
    <svg class="star-icon-large" fill="none" stroke="currentColor" viewBox="0 0 24 24">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11.049 2.927c.3-.921 1.603-.921 1.902 0l1.519 4.674a1 1 0 00.95.69h4.915c.969 0 1.371 1.24.588 1.81l-3.976 2.888a1 1 0 00-.363 1.118l1.518 4.674c.3.922-.755 1.688-1.538 1.118l-3.976-2.888a1 1 0 00-1.176 0l-3.976 2.888c-.783.57-1.838-.197-1.538-1.118l1.518-4.674a1 1 0 00-.363-1.118l-3.976-2.888c-.784-.57-.38-1.81.588-1.81h4.914a1 1 0 00.951-.69l1.519-4.674z" />
    </svg>
    <p>{{ translation.t('No reviews yet') || 'No reviews yet' }}</p>
    <p class="empty-subtitle">{{ translation.t('Complete an order and rate it to see your reviews here') || 'Complete an order and rate it to see your reviews here' }}</p>
  </div>
} @else {
  <div class="reviews-content">
    <div class="reviews-header">
      <h3 class="reviews-title">
        <svg class="message-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z" />
        </svg>
        Your Reviews ({{ userReviews.length }})
      </h3>
    </div>
    <div class="reviews-grid">
      @for (review of userReviews; track review.orderId) {
        <div class="review-card">
          <div class="review-header">
            <div class="review-info">
              <p class="review-order-id">Order #{{ getOrderId(review.orderId) }}</p>
              <p class="review-courier">{{ translation.t('Courier') || 'Courier' }}: {{ review.courier.name }}</p>
              <p class="review-date">
                <svg class="calendar-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" />
                </svg>
                {{ formatDate(review.reviewedAt) }}
              </p>
            </div>
            <div class="review-actions">
              <button
                class="edit-btn"
                (click)="onEditReview(review)"
                title="Edit Review"
              >
                <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z" />
                </svg>
              </button>
              <button
                class="delete-btn"
                (click)="onDeleteReview(review)"
                [disabled]="deletingReviewId === review.orderId"
                title="Delete Review"
              >
                @if (deletingReviewId === review.orderId) {
                  <div class="spinner"></div>
                } @else {
                  <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" />
                  </svg>
                }
              </button>
            </div>
          </div>
          <div class="review-rating">
            @for (star of [1,2,3,4,5]; track star) {
              <svg
                class="star-icon"
                [class.filled]="star <= review.stars"
                fill="currentColor"
                viewBox="0 0 24 24"
              >
                <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z" />
              </svg>
            }
            <span class="rating-text">({{ review.stars }}/5)</span>
          </div>
          @if (review.comment) {
            <p class="review-comment">{{ review.comment }}</p>
          }
        </div>
      }
    </div>
  </div>
}

