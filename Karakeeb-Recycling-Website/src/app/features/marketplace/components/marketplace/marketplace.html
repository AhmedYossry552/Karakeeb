<div class="marketplace-container">
  <!-- Search and Filter Section -->
  <section class="marketplace-header">
    <div class="search-filter-wrapper">
      <div class="search-wrapper">
        <svg class="search-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
        </svg>
        <input
          type="text"
          [placeholder]="translation.t('Search') || 'Search'"
          [value]="searchTerm()"
          (input)="onSearchChange($any($event.target).value)"
          class="search-input"
        />
      </div>

      <div class="filter-wrapper">
        <svg class="filter-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z" />
        </svg>
        <select
          [value]="selectedCategory()"
          (change)="onCategoryChange($any($event.target).value)"
          class="category-select"
        >
          <option value="all">{{ translation.t('All Categories') || 'All Categories' }}</option>
          <option *ngFor="let category of categories()" [value]="category">
            {{ category }}
          </option>
        </select>
      </div>
    </div>
  </section>

  <!-- Results Info -->
  <div class="results-info">
    <span class="results-text">
      {{ translation.t('Showing') || 'Showing' }} {{ translation.convertNumber ? translation.convertNumber(sortedFilteredItems().length) : sortedFilteredItems().length }} 
      {{ translation.t('common.of') !== 'common.of' ? translation.t('common.of') : 'of' }} {{ translation.convertNumber ? translation.convertNumber(pagination().totalItems) : pagination().totalItems }} 
      {{ translation.t('Items') || 'Items' }}
    </span>
    <span class="page-info">
      {{ translation.t('Page') || 'Page' }} {{ translation.convertNumber ? translation.convertNumber(pagination().currentPage) : pagination().currentPage }} 
      {{ translation.t('Of') || 'Of' }} {{ translation.convertNumber ? translation.convertNumber(pagination().totalPages) : pagination().totalPages }}
    </span>
  </div>

  <!-- Main Content -->
  <main class="marketplace-content">
    <!-- Loading State -->
    <div *ngIf="isLoading() && items().length === 0" class="loading-skeleton">
      <div *ngFor="let _ of [].constructor(12)" class="skeleton-card"></div>
    </div>

    <!-- Empty State -->
    <div *ngIf="!isLoading() && sortedFilteredItems().length === 0" class="empty-state">
      <svg class="empty-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.172 16.172a4 4 0 015.656 0M9 10h.01M15 10h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
      </svg>
      <h2 class="empty-title">
        {{ translation.t('No Items Found') || 'No Items Found' }}
      </h2>
      <p class="empty-description">
        <span *ngIf="searchTerm() || selectedCategory() !== 'all'">
          {{ translation.t('Try Different Search') || 'Try Different Search' }}
        </span>
        <span *ngIf="!searchTerm() && selectedCategory() === 'all'">
          {{ translation.t('No Items Available') || 'No Items Available' }}
        </span>
      </p>
      <p *ngIf="searchTerm()" class="empty-hint">
            {{ translation.t('Cross Language Hint') || 'Cross Language Hint' }}
      </p>
    </div>

    <!-- Items Grid -->
    <div *ngIf="!isLoading() && sortedFilteredItems().length > 0" class="items-grid">
      <app-item-card
        *ngFor="let item of sortedFilteredItems(); let i = index; trackBy: trackByItemId"
        [item]="item"
        [index]="i"
        [isFetching]="isFetching()"
        [user]="user"
      />
    </div>

    <!-- Pagination -->
    <div *ngIf="pagination().totalPages > 1 && !isLoading()" class="pagination-wrapper">
      <app-pagination
        [pagination]="pagination()"
        (pageChange)="onPageChange($event)"
      />
    </div>
  </main>
</div>

<!-- Voice Processing Component -->
<app-floating-recorder-button></app-floating-recorder-button>

